@page "/"
@inject IJSRuntime JS

<h3>Hello, Leaflet + Blazor ðŸ‘‹</h3>
<p>This is a minimal demo.</p>

<div id="map"></div>

@if (!string.IsNullOrEmpty(_error))
{
    <div class="alert alert-warning mt-3">JS init failed: @_error</div>
}

@code {
    private string? _error;

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try
            {
                await JS.InvokeVoidAsync("initLeafletMap");
            }
            catch (JSException jsex)
            {
                _error = jsex.Message;
                StateHasChanged();
            }
            catch (Exception ex)
            {
                _error = ex.Message;
                StateHasChanged();
            }
        }
    }
}
